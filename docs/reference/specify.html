<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Specify a model. — specify • BayesHMM</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Specify a model. — specify" />

<meta property="og:description" content="See below for details on model specification." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BayesHMM</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">An Introduction to BayesHMM</a>
    </li>
    <li>
      <a href="../articles/introduction2.html">An Introduction to BayesHMM</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/luisdamiano/BayesHMM/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Specify a model.</h1>
    <small class="dont-index">Source: <a href='https://github.com/luisdamiano/BayesHMM//blob/master/R/specification.R'><code>R/specification.R</code></a></small>
    <div class="hidden name"><code>specify.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>See below for details on model specification.</p>
    
    </div>

    <pre class="usage"><span class='fu'>specify</span>(<span class='no'>K</span>, <span class='no'>R</span>, <span class='kw'>observation</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>initial</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>transition</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>""</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>K</th>
      <td><p>An integer with the number of hidden states.</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>An integer with the dimension of the observation vector (e.g. one is univariate, two is bivariate)</p></td>
    </tr>
    <tr>
      <th>observation</th>
      <td><p>One density, or more than one density chained with the `+` operator, describing the observation model. See below and future vignette for detailed explanation.</p></td>
    </tr>
    <tr>
      <th>initial</th>
      <td><p>One density, or more than one density chained with the `+` operator, describing the initial distribution model. See below and future vignette for detailed explanation.</p></td>
    </tr>
    <tr>
      <th>transition</th>
      <td><p>One density, or more than one density chained with the `+` operator, describing the transition model. See below and future vignette for detailed explanation.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>An optional character string with a name for a model.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>Specification</code> object that may be used to validate calibration (<code><a href='validate_calibration.html'>validate_calibration</a></code>), compiled (<code><a href='compile.html'>compile</a></code>), generate data from <code><a href='sim.html'>sim</a></code>, or fit a model to data to obtain a point estimate (<code><a href='optimizing.html'>optimizing</a></code>) or run full-bayesian inference via Markov-chain Monte Carlo (<code><a href='fit.html'>fit</a></code>).</p>
    
    <h2 class="hasAnchor" id="model-specification"><a class="anchor" href="#model-specification"></a>Model specification</h2>

    
    <p>A Hidden Markov Model may be seen as three submodels that jointly specify the dinamics of the observed random variable. To specify the observation, initial distribution, and transition models, we designed S3 objects called <code><a href='Density.html'>Density</a></code> that define density form, parameter priors, and fixed values for parameters. These are flexible enough to include bounds in the parameter space as well as truncation in prior densities.</p>
<p>Internally, a <code>Specification</code> object is a nested list storing either <em>K</em> multivariate densities (i.e. one multivariate density for state) or <em>K x R</em> univariate densities (i.e. one univariate density for each dimension in the observation variable and each state). (what does this depend on?) However, the user is not expected to known the internal details of the implementation. Instead, user-input will be interpreted based on three things: the dimension of the observation vector <em>R</em>, the number of densities given by the user, and the type of density given by the user.</p>
<p><strong>Univariate observation model</strong> (i.e. <em>R</em> = 1):</p><ol>
<li><p>Enter one univariate density if you want the observation variable to have the same density and parameter priors in every hidden state. Note that, although the user input is recycled for every hidden state for the purpose of model specification, parameters are not shared across states. All parameters are free.</p></li>
<li><p>Enter <em>K</em> univariate densities if you want the observation variable to have different densities and/or parameter priors in each hidden state.</p></li>
</ol>
    <pre>
  # Assume K = 2, R = 1
  # 1. Same density and priors in every state
  observation = Gaussian(
    mu    = Gaussian(0, 10),
    sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
  )
    # 2. (a) Different priors for each of the K = 2 possible hidden states
  observation =
    Gaussian(
      mu    = Gaussian(0, 10),
      sigma = Student(mu = 0, sigma =  1, nu = 1, bounds = list(0, NULL))
    ) +
    Gaussian(
      mu    = Gaussian(0, 10),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    )
    # 2. (b) Different densities for each of the K = 2 possible hidden states
       (i.e. the observed variable has heavy tails on the second state).
  observation =
    Gaussian(
      mu    = Gaussian(0, 10),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    ) +
    Student(
      mu    = Gaussian(0, 10),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
      nu    = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    )
</pre>
    <p><strong>Multivariate observation model</strong> (i.e. <em>R</em> &gt; 1):</p><ol>
<li><p>Enter one univariate density if you want every dimension of the observation vector to have the same density and parameter priors in every hidden state. In this case, the user specifies the marginal density of independent random variables.</p></li>
<li><p>Enter one multivariate density if you want the observation vector to have the same joint density and parameter priors in every hidden state. In this case, the user specifies the joint density of random variables.</p></li>
<li><p>Enter <em>K</em> univariate densities if you want every dimension of the observation vector to have the same density and parameter priors within each hidden state. In this case, the user specifies the marginal density of independent random variables for each state. In other words, given a latent state, each variable in the observation vector will have the same density and parameter priors.</p></li>
<li><p>Enter <em>K</em> multivariate densities if you want the observation vector to have different densities and/or parameter priors in each hidden state. In this case, the user specifies a joint density and parameter priors that varies per state.</p></li>
<li><p>Enter <em>R</em> univariate densities if you want each dimension of the observation vector to have different densities and parameter priors, but these specification should the same in every hidden state. In this case, the user specifies the marginal density of independent elements of a random vector, and this specification is the same in all latent states.</p></li>
<li><p>Enter <em>R x K</em> univariate densities if you want each dimension of the observation vector to have different densities and parameter priors in each hidden state. In this case, the user specifies the marginal density of independent elements of a random vector which also varies for each latent state.</p></li>
</ol>
    <pre>
  # Assume K = 2, R = 2
  # 1. Same density for every dimension of the random vector and hidden state
  observation = Gaussian(
    mu    = Gaussian(0, 10),
    sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
  )
    # 2. Same density for the random vector in every hidden state
  observation = MVGaussianCor(
    mu    = MVGaussian(mu = c(0, 0), sigma = matrix(c(100, 0, 0, 100), 2, 2)),
    L     = LKJCor(eta = 2)
  )
    # 3. Different density for each dimension of the random vector, but the
       specification is the same across hidden states (i.e. we believe the
       observed variable has heavy tails on the second state).
  observation =
    Gaussian(
      mu    = Gaussian(0, 10),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    ) +
    Student(
      mu    = Gaussian(0, 10),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
      nu    = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    )
    # 4. Different priors in each hidden state
  observation =
    MVGaussianCor(
      mu    = MVGaussian(mu = c(0, 0), sigma = matrix(c(100, 0, 0, 100), 2, 2)),
      L     = LKJCor(eta = 2)
    ) +
    MVGaussianCor(
      mu    = MVGaussian(mu = c(1, -1), sigma = matrix(c(100, 0, 0, 100), 2, 2)),
      L     = LKJCor(eta = 2)
    )
    # 5. Cannot be used in this case since K = R = 2. See paragraph below.
    # 6. Different density for for each dimension and hidden state
    Gaussian(
      mu    = Gaussian(0, 10),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    ) +
    Student(
      mu    = Gaussian(0, 10),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
      nu    = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    ) +
    Gaussian(
      mu    = Gaussian(0, 1),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    ) +
    Student(
      mu    = Gaussian(0, 1),
      sigma = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
      nu    = Student(mu = 0, sigma = 10, nu = 1, bounds = list(0, NULL))
    )
</pre>
    <p>The last specifications, admittedly intricate and little natural, are provided in case the user has very specific modeling needs. When <em>K = R</em>, cases 3 and 5 clash and the software will read it as case 3. Note that, although the user input is recycled for every for the purpose of model specification, parameters are never shared across dimensions or states. All parameters are free.</p>
<p><strong>Initial model</strong>:</p><ol>
<li><p>Enter one univariate density if you want each every initial state probability to have the same parameter priors. In this case, the user specifies the marginal density of independent initial state probabilities. Note that, although these priors may not guarantee per se that the elements of initial vector sum to one, this is not problematic for estimation. The log posterior density will only be affected by the relative strength of these priors even if they are not normalized.</p></li>
<li><p>Enter <em>K</em> univariate densities if you want each initial state probability to have different priors. Additional comments from the previous item apply.</p></li>
<li><p>Enter one multivariate density if you want to define a joint prior for all the elements of the initial distribution vector.</p></li>
</ol>
    <pre>
  # Assume K = 2
  # 1. Same prior (uniform) for every initial state probability
  initial = Beta(alpha = 1, beta = 1)
    # 2. Different priors for each of the K = 2 initial state probabilities
  initial = Beta(alpha = 0.7, beta = 1) + Beta(alpha = 1, beta = 0.7)
    # 2. One multivariate prior for the initial state vector
  initial = Dirichlet(alpha = c(1, 1))
</pre>
    <p>Specification #3 is most suitable for most of the problem, unless the user has very specific modeling needs. Useful densities for this model include <code><a href='Beta.html'>Beta</a></code> and <code><a href='Dirichlet.html'>Dirichlet</a></code>.</p>
<p><strong>Transition model</strong>:</p><ol>
<li><p>Enter one univariate density if you want all the <em>K x K</em> elements of the transition matrix to have the same prior. In this case, the user specifies the marginal prior of transition probabilities. Note that, although these priors may not guarantee per se that the elements of each row sum to one, this is not problematic for estimation. The log posterior density will only be affected by the relative strength of these priors even if they are not normalized.</p></li>
<li><p>Enter one multivariate density if you want every <em>K</em>-sized row of the transition matrix to have the same prior. In this case, the user specifies the joint prior of the transition probability for any given starting state.</p></li>
<li><p>Enter <em>K</em> univariate densities if you want each element of any given row to have different priors. In this case, the user specifies the marginal prior for the <em>K</em> transition probabilities for any given starting state. Additional comments from the first item apply.</p></li>
<li><p>Enter <em>K</em> multivariate densities if you want each <em>K</em>-sized row of the transition matrix to have the multivariate same prior. In this case, the user specifies the joint prior of the transition probability that varies for each starting state.</p></li>
<li><p>Enter <em>KxK</em> univariate densities if you want each element of the transition matrix to have a different prior. In this case, the user specifies the marginal prior for the <em>KxK</em> transition probabilities. Additional comments from the first item apply.</p></li>
</ol>
    <pre>
  # Assume K = 2
  # 1. Same prior (uniform) for each of the KxK elements of the matrix
  transition = Beta(alpha = 1, beta = 1)
    # 2. Same prior (uniform) for each of the K rows of the matrix
  transition = Dirichlet(alpha = c(1, 1))
    # 3. Different priors for each element in a row
  transition = Beta(alpha = 0.7, beta = 1) + Beta(alpha = 1, beta = 0.7)
    # 4. Different priors for each row
  transition = Dirichlet(alpha = c(0.7, 1)) + Dirichlet(alpha = c(1, 0.7))
    # 5. Different priors for each element in the matrix
  transition =
    Beta(alpha = 0.7, beta = 1) + Beta(alpha = 1, beta =   1) +
    Beta(alpha =   1, beta = 1) + Beta(alpha = 1, beta = 0.7)
</pre>
    <p>Specifications #2 and #4 are most suitable for most of the problem, unless the user has very specific modeling needs. Useful densities for this model include <code><a href='Beta.html'>Beta</a></code> and <code><a href='Dirichlet.html'>Dirichlet</a></code>.</p>
<p><strong>Fixed parameters</strong>
Note that fixed parameters may be specified following this example:</p>
<pre>
  # Gaussian density with fixed standard deviation
  observation = Gaussian(
    mu    = Gaussian(0, 10),
    sigma = 1
  )
</pre>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='compile.html'>compile</a></code>, <code><a href='explain.html'>explain</a></code>, <code><a href='fit.html'>fit</a></code>, <code><a href='optimizing.html'>optimizing</a></code>, <code><a href='sim.html'>sim</a></code>, <code><a href='validate_calibration.html'>validate_calibration</a></code>.</p>
<p>Other models: <code><a href='hmm.html'>hmm</a></code>, <code><a href='mixture.html'>mixture</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>mySpec</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='hmm.html'>hmm</a></span>(
  <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>R</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>observation</span> <span class='kw'>=</span> <span class='fu'><a href='Gaussian.html'>Gaussian</a></span>(
    <span class='kw'>mu</span>    <span class='kw'>=</span> <span class='fu'><a href='Gaussian.html'>Gaussian</a></span>(<span class='fl'>0</span>, <span class='fl'>10</span>),
    <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fu'><a href='Student.html'>Student</a></span>(
      <span class='kw'>mu</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>bounds</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='fl'>0</span>, <span class='kw'>NULL</span>)
    )
  ),
  <span class='kw'>initial</span>     <span class='kw'>=</span> <span class='fu'><a href='Dirichlet.html'>Dirichlet</a></span>(<span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>1</span>)),
  <span class='kw'>transition</span>  <span class='kw'>=</span> <span class='fu'><a href='Dirichlet.html'>Dirichlet</a></span>(<span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>1</span>)),
  <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"Univariate Gaussian Hidden Markov Model"</span>
)

<span class='fu'><a href='explain.html'>explain</a></span>(<span class='no'>mySpec</span>)</div><div class='output co'>#&gt; UNIVARIATE GAUSSIAN HIDDEN MARKOV MODEL                                         
#&gt; ________________________________________________________________________________
#&gt; 
#&gt; Univariate observations (R = 1): Variable names.
#&gt; 
#&gt; Observation model for all states
#&gt; Variable Density: Gaussian (-infty, infty)
#&gt;   Free parameters: 2 (mu, sigma)
#&gt;     mu    = Prior Density: Gaussian (-infty, infty)
#&gt;       Fixed parameters: 2 (mu = 0, sigma = 10), 
#&gt;     sigma = Prior Density: Student [0, infty)
#&gt;       Fixed parameters: 3 (mu = 0, sigma = 10, nu = 1)
#&gt; 
#&gt; Initial distribution model
#&gt; Prior Density: Dirichlet (-infty, infty)
#&gt;   Fixed parameters: 1 (alpha = 11)
#&gt; 
#&gt; Transition model
#&gt; Prior Density: Dirichlet (-infty, infty)
#&gt;   Fixed parameters: 1 (alpha = 11)
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#model-specification">Model specification</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Luis Damiano, Michael Weylandt, Brian Peterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

